;; -*- mode: lisp -*-
(defmodule sqlite3-test
  (:use :austral)
  (:import-from :austral.ext.cffi
                :defcfun))
(in-module :sqlite3-test)

(defcfun (sqlite3-open "sqlite3_open") ((path (paddress u8))
                                        (pointer (paddress (address u8))))
  i32)

(defun main () i32
  (let ((handle (null-pointer u8)))
    (let ((open-rc (sqlite3-open (static-array-pointer ":memory:")
                                 (address-of handle))))
      (if (austral.kernel:eq open-rc 0)
          0
          -1))))
