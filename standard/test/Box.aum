import Standard.Box (
    Box,
    makeBox,
    unbox
);
import Standard.Test.Unit (
    assertTrue,
    assertFailure,
    suiteHeading,
    testHeading
);

module body Standard.Test.Box is
    function boxTestSuite(): Unit is
        suiteHeading("Standard.Box");
        basicLifecycleTest();
        return nil;
    end;

    function basicLifecycleTest(): Unit is
        testHeading("Basic lifecycle.");
        let e: Either[Box[Int32], Int32] := makeBox(10);
        case e of
            when Left(left as box: Box[Int32]) do
                 let i: Int32 := unbox(box);
                 assertTrue(i = 10, "box contents equal 10");
            when Right(right: Int32) do
                 assertFailure("makeBox failed.");
        end case;
        return nil;
    end;
end module body.